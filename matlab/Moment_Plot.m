%% TAO TAP HOP CAC DIEM QUY DAO MO PHONG
% syms l1 l2 l3 l4 l5 lc1 lc2 lc3 lc4 lc5
% syms t1 t2 t3 t4 t5
% syms Ixx1 Iyy1 Iyy2 Iyy3 Iyy4 Iyy5 Izz5
% syms m1 m2 m3 m4 m5

Ixx1 = 4.61147
Iyy1 = 29.9920
Iyy2 = 8.03322
Iyy3 = 16.04504
Iyy4 = 0.06328
Iyy5 = 0.24861 
Izz5 = 0.14388 

m1 = 27.5 %kg
m2 = 24.0
m3 = 25.0
m4 = 3.0
m5 = 15.0

l1=690;
l2=440;
l3=500;
l5=230;

lc1 = 0.660 %m
lc2 = 0.255
lc3 = 0.143
lc4 = 0.6
lc5 = 0.143

data = csvread('data_robot_tinh_toan_moi.csv', 0, 0); % 'file.csv' là tên tệp CSV, 0 là số dòng bắt đầu (0 nếu không có dòng tiêu đ�?), 1 là số cột (cột thứ 2)

time = data(:, 1)
t1_array = data(:, 2)
t2_array = data(:, 3)
t3_array = data(:, 4)
t4_array = data(:, 5)
t5_array = data(:, 6)

t1_d_array = data(:, 8)
t2_d_array = data(:, 9)
t3_d_array = data(:, 10)
t4_d_array = data(:, 11)

t1_dd_array = data(:, 12)
t2_dd_array = data(:, 13)
t3_dd_array = data(:, 14)
t4_dd_array = data(:, 15)

t1 = 0 %rad
t2 = 0
t3 = 0
t4 = - pi / 2
t5 = 0

for i = 1:1:290

     t1 = t1_array(i) %rad
     t2 = t2_array(i)
     t3 = t3_array(i)
     t4 = t4_array(i)
     t5 = t5_array(i)

     % t1_d = t1_d_array(i) * pi / 180;
     % t2_d = t2_d_array(i) * pi / 180;
     % t3_d = t3_d_array(i) * pi / 180;
     % t4_d = t4_d_array(i) * pi / 180;
     % t5_d = 0;

     % % TAO MA TRAN GIA TOC
     % t1_dd = t1_dd_array(i) * pi / 180;
     % t2_dd = t2_dd_array(i) * pi / 180;
     % t3_dd = t3_dd_array(i) * pi / 180;
     % t4_dd = t4_dd_array(i) * pi / 180;
     % t5_dd = 0;

     % q_dd = [t1_dd ; t2_dd ; t3_dd ; t4_dd ; t5_dd];

     % %% RUT GON KET QUA BIEU THUC G
     % G1 = 0
     % G2 = (49*m4*(l3*cos(t2 + t3) + l2*cos(t2)))/5 + (49*m5*(l3*cos(t2 + t3) + l2*cos(t2)))/5 + (49*m3*(lc3*cos(t2 + t3) + l2*cos(t2)))/5 + (49*lc2*m2*cos(t2))/5
     % G3 = (49*l3*m4*cos(t2 + t3))/5 + (49*l3*m5*cos(t2 + t3))/5 + (49*lc3*m3*cos(t2 + t3))/5
     % G4 = 0
     % G5 = 0

     % G = [G1; G2; G3; G4; G5;]

     % %% RUT GON KET QUA BIEU THUC D
     % D11 = Iyy1 + Izz5 + Iyy2*cos(t2)*cos(t2) + Iyy3*cos(t2 + t3)*cos(t2 + t3) ...
     % + m4*cos(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (l3))*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t1)*cos(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos...
     % (t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc2)*...
     % (lc3*cos(t2 + t3) + l2*cos(t2)) + m4*sin(t1)*sin(t1)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*sin(t1)...
     % *sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + ...
     % t3) + l2*cos(t2)) + m3*sin(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc2)*(lc3*cos(t2 + t3) + l2*cos(t2)) + lc2*m2*cos(t1)*cos(...
     % (t2))*lc2*cos(t1)*cos(t2) + lc2*m2*cos(t2)*sin(t1)*lc2*cos...
     % (t2)*sin(t1)

     % D12 = Iyy2*sin(t1)*sin(t2)*cos(t1)*cos(t2) - Iyy2*cos(t1)*sin(t2)...
     % *cos(t2)*sin(t1) - m4*cos(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + m4*sin(t1)*cos(t1)*(cos...
     % (t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin...
     % (t2)) - m5*cos(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)...
     % *l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*sin(t1)*cos(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) - ...
     % m3*cos(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (lc3))*(lc3*sin(t2 + t3) + l2*sin(t2)) + m3*sin(t1)*cos(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*lc2)*(lc3*sin(t2 + t3) + l2*sin(t2)) - Iyy3*cos...
     % (t1)*sin(t2 + t3)*cos(t2 + t3)*sin(t1) + Iyy3*sin(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*cos(t1) - lc2*m2*cos(t1)*cos(t2)*...
     % (lc2)*sin(t1)*sin(t2) + lc2*m2*cos(t2)*sin(t1)*lc2*cos(t1)*sin(t2)

     % D13 = Iyy3*sin(t1)*sin(t2 + t3)*cos(t2 + t3)*cos(t1) - Iyy3*cos(t1)...
     % *sin(t2 + t3)*cos(t2 + t3)*sin(t1) - l3*m4*cos(t1)*sin(t2 + t3)*sin...
     % (t1)*(cos(t2)*l2 + cos(t2 + t3)*l3) + l3*m4*sin(...
     % (t1))*sin(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (l3)) - l3*m5*cos(t1)*sin(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(...
     % (t2) + t3)*l3) + l3*m5*sin(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3) - lc3*m3*cos(t1)*sin(t2 + t3)...
     % *sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc2) + lc3*m3*sin...
     % (t1)*sin(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)...
     % *lc2)

     % D14 = 0

     % D15 = -Izz5

     % D21 = Iyy2*cos(t2)*(cos(t1)*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2)) + ...
     % Iyy3*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin...
     % (t2 + t3)*cos(t1)) + m4*cos(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3) - m4*sin(t1)*cos(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)...
     % *l3) + m5*cos(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)...
     % *l2 + sin(t2 + t3)*l3) - m5*sin(t1)*cos(t1)*(l3*cos(t2 ...
     % + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)*l3) + ...
     % m3*cos(t1)*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + ...
     % sin(t2 + t3)*lc2) - m3*sin(t1)*cos(t1)*(lc3*cos(t2 + t3) + ...
     % l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)*lc2) + ...
     % lc2*m2*cos(t1)*sin(t2)*lc2*cos(t2)*sin(t1) - lc2*m2*sin(t1)...
     % *sin(t2)*lc2*cos(t1)*cos(t2)

     % D22 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
     % *sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
     % (t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
     % (t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
     % sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
     % *sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(...
     % (t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(...
     % (t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy2*cos(t1)*(cos(t1)...
     % *cos(t1) + sin(t1)*sin(t1)) + Iyy2*sin(t1)*sin(t2)*(cos(t1)...
     % *sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2))) + sin(t1)*(Iyy2*sin(t1)*(cos...
     % (t1)*cos(t1) + sin(t1)*sin(t1)) - Iyy2*cos(t1)*sin(t2)*(cos...
     % (t1)*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2))) + cos(t1)*(Iyy5*(cos...
     % (t1)*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos...
     % (t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*...
     % (cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)...
     % *sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + ...
     % m4*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)) + m5*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos...
     % (t2 + t3) + l2*cos(t2)) + m3*(cos(t2)*l2 + cos(t2 + t3)*...
     % (lc3))*(lc3*cos(t2 + t3) + l2*cos(t2)) + m4*cos(t1)*cos(t1)*(sin(t2)*...
     % (l2) + sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos...
     % (t1)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*cos(t1)*(sin(t2)*l2 + ...
     % sin(t2 + t3)*lc2)*(lc3*sin(t2 + t3) + l2*sin(t2)) + lc2*m2*cos(...
     % (t2))*lc2*cos(t2) + m4*sin(t1)*sin(t1)*(sin(t2)*l2 + sin(...
     % (t2) + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*sin(t1)*sin(t1)*...
     % (sin(t2)*l2 + sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)) + m3*sin(t1)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % (t3))*lc2)*(lc3*sin(t2 + t3) + l2*sin(t2)) + lc2*m2*cos(t1)*sin(t2)...
     % *lc2*cos(t1)*sin(t2) + lc2*m2*sin(t1)*sin(t2)*lc2*sin(t1)*sin...
     % (t2)

     % D23 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
     % *sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
     % (t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
     % (t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
     % sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
     % *sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(...
     % (t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(...
     % (t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(t1)*cos(t5) ...
     % + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - ...
     % sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos(t1)*sin(...
     % (t5)) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin(t5) - cos(t5)*sin...
     % (t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + l3*m4*cos(t2 + t3)*(cos...
     % (t2)*l2 + cos(t2 + t3)*l3) + l3*m5*cos(t2 + t3)*(cos...
     % (t2)*l2 + cos(t2 + t3)*l3) + lc3*m3*cos(t2 + t3)*(cos...
     % (t2)*l2 + cos(t2 + t3)*lc2) + l3*m4*cos(t1)*sin...
     % (t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3) + ...
     % l3*m5*cos(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3) + lc3*m3*cos(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*...
     % (l2) + sin(t2 + t3)*lc2) + l3*m4*sin(t1)*sin(t2 + t3)*sin(t1)...
     % *(sin(t2)*l2 + sin(t2 + t3)*l3) + l3*m5*sin(t1)...
     % *sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3) + ...
     % lc3*m3*sin(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc2)

     % D24 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
     % (t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
     % (t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(...
     % (t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
     % sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
     % (t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
     % (t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

     % D25 = 0

     % D31 = Iyy3*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin...
     % (t2 + t3)*cos(t1)) + m4*cos(t1)*sin(t2 + t3)*l3*sin(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2)) - m4*sin(t1)*sin(t2 + t3)*l3...
     % *cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t1)*sin(t2 + t3)...
     % *l3*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) - m5*sin(t1)*sin(t2 + ...
     % t3)*l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos(t1)*sin(...
     % (t2) + t3)*lc2*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)) - m3*sin(t1)...
     % *sin(t2 + t3)*lc2*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))

     % D32 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
     % *sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
     % (t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
     % (t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
     % sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
     % *sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(...
     % (t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(...
     % (t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(t1)*cos(t5) ...
     % + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - ...
     % sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos(t1)*sin(...
     % (t5)) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin(t5) - cos(t5)*sin...
     % (t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + m4*cos(t2 + ...
     % (t3))*l3*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t2 + t3)*l3*...
     % (l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos(t2 + t3)*lc2*(lc3*cos(t2 + ...
     % t3) + l2*cos(t2)) + m4*cos(t1)*sin(t2 + t3)*l3*cos(t1)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos(t1)*sin(t2 + t3)*l3...
     % *cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*sin(t2 + t3)...
     % *lc2*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)) + m4*sin(t1)*sin(t2 + ...
     % t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*sin(t1)*sin(...
     % (t2) + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*sin(t1)...
     % *sin(t2 + t3)*lc2*sin(t1)*(lc3*sin(t2 + t3) + l2*sin(t2))

     % D33 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
     % *sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
     % (t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
     % (t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
     % sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
     % *sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(...
     % (t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(...
     % (t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(t1)*cos(t5) ...
     % + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - ...
     % sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos(t1)*sin(...
     % (t5)) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin(t5) - cos(t5)*sin...
     % (t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + l3*m4*cos(t2 + ...
     % t3)*cos(t2 + t3)*l3 + l3*m5*cos(t2 + t3)*cos(t2 + t3)*...
     % (l3) + lc3*m3*cos(t2 + t3)*cos(t2 + t3)*lc2 + l3*m4*cos(t1)...
     % *sin(t2 + t3)*sin(t2 + t3)*l3*cos(t1) + l3*m5*cos(t1)*sin...
     % (t2 + t3)*sin(t2 + t3)*l3*cos(t1) + lc3*m3*cos(t1)*sin(...
     % (t2) + t3)*sin(t2 + t3)*lc2*cos(t1) + l3*m4*sin(t1)*sin(t2 + ...
     % t3)*sin(t2 + t3)*l3*sin(t1) + l3*m5*sin(t1)*sin(t2 + ...
     % (t3))*sin(t2 + t3)*l3*sin(t1) + lc3*m3*sin(t1)*sin(t2 + t3)...
     % *sin(t2 + t3)*lc2*sin(t1)

     % D34 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
     % (t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
     % (t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(...
     % (t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
     % sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
     % (t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
     % (t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

     % D35 = 0

     % D41 = 0

     % D42 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
     % (t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
     % (t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(...
     % (t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
     % sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
     % (t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
     % (t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

     % D43 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
     % (t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
     % (t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(...
     % (t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
     % sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
     % (t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
     % (t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

     % D44 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(...
     % (t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
     % *sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
     % (t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
     % (t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
     % *sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
     % (t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
     % (t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(...
     % (t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
     % sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
     % (t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
     % (t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

     % D45 = 0

     % D51 = -Izz5

     % D52 = 0

     % D53 = 0

     % D54 = 0

     % D55 = Izz5

     % %% RUT GON KET QUA BIEU THUC V
     
     % V1 = t3_d^2*(Iyy3*cos(t1)*sin(t2 + t3)*sin(t2 + t3)*sin(t1) - Iyy3*sin...
     % (t1)*sin(t2 + t3)*sin(t2 + t3)*cos(t1) - Iyy3*cos(t1)*cos...
     % (t2 + t3)*cos(t2 + t3)*sin(t1) + Iyy3*sin(t1)*cos(t2 + ...
     % (t3))*cos(t2 + t3)*cos(t1) - l3*m4*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3) + l3*m4*sin(t1)*cos(t2 + t3)*cos...
     % (t1)*(cos(t2)*l2 + cos(t2 + t3)*l3) - l3*m5*cos(...
     % (t1))*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (l3)) + l3*m5*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(...
     % (t2) + t3)*l3) - lc3*m3*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*lc3) + lc3*m3*sin(t1)*cos(t2 + t3)...
     % *cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3) + l3*m4*cos...
     % (t1)*sin(t2 + t3)*sin(t2 + t3)*l3*sin(t1) - l3*m4*sin(...
     % (t1))*sin(t2 + t3)*sin(t2 + t3)*l3*cos(t1) + l3*m5*cos(t1)...
     % *sin(t2 + t3)*sin(t2 + t3)*l3*sin(t1) - l3*m5*sin(t1)*sin...
     % (t2 + t3)*sin(t2 + t3)*l3*cos(t1) + lc3*m3*cos(t1)*sin(...
     % (t2) + t3)*sin(t2 + t3)*lc3*sin(t1) - lc3*m3*sin(t1)*sin(t2 + ...
     % t3)*sin(t2 + t3)*lc3*cos(t1)) + t2_d^2*(Iyy3*cos(t1)*sin(t2 + ...
     % t3)*sin(t2 + t3)*sin(t1) - Iyy3*sin(t1)*sin(t2 + t3)*sin(t2 + ...
     % t3)*cos(t1) + m4*cos(t1)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % (t3))*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) - m4*sin(t1)*cos(t1)*(sin(...
     % (t2))*l2 + sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + ...
     % m5*cos(t1)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3)...
     % *(l3*sin(t2 + t3) + l2*sin(t2)) - m5*sin(t1)*cos(t1)*(sin(t2)*l2 + ...
     % sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)...
     % *sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3)*(lc3*sin(t2 + ...
     % t3) + l2*sin(t2)) - m3*sin(t1)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)) - m4*cos(t1)*sin(t1)*(cos...
     % (t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + l2*cos...
     % (t2)) + m4*sin(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)...
     % *l3)*(l3*cos(t2 + t3) + l2*cos(t2)) - m5*cos(t1)*sin(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)) + ...
     % m5*sin(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3)...
     % *(l3*cos(t2 + t3) + l2*cos(t2)) - m3*cos(t1)*sin(t1)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*lc3)*(lc3*cos(t2 + t3) + l2*cos(t2)) + m3*sin(...
     % (t1))*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3)*(lc3*cos...
     % (t2 + t3) + l2*cos(t2)) - Iyy2*cos(t1)*cos(t2)*cos(t2)*sin(t1) + Iyy2*cos...
     % (t2)*sin(t1)*cos(t1)*cos(t2) - Iyy3*cos(t1)*cos(t2 + ...
     % (t3))*cos(t2 + t3)*sin(t1) + Iyy3*sin(t1)*cos(t2 + t3)*cos(t2 + t3)...
     % *cos(t1) + Iyy2*cos(t1)*sin(t2)*sin(t1)*sin(t2) - Iyy2*sin(t1)*sin...
     % (t2)*cos(t1)*sin(t2) - lc2*m2*cos(t1)*cos(t2)*lc2*cos(t2)*sin...
     % (t1) + lc2*m2*cos(t2)*sin(t1)*lc2*cos(t1)*cos(t2) + lc2*m2*cos(...
     % (t1))*sin(t2)*lc2*sin(t1)*sin(t2) - lc2*m2*sin(t1)*sin(t2)...
     % *lc2*cos(t1)*sin(t2)) + t2_d*t3_d*(Iyy3*cos(t1)*sin(t2 + t3)...
     % *sin(t2 + t3)*sin(t1) - Iyy3*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*cos...
     % (t1) - Iyy3*cos(t1)*cos(t2 + t3)*cos(t2 + t3)*sin(t1) + Iyy3*sin...
     % (t1)*cos(t2 + t3)*cos(t2 + t3)*cos(t1) - l3*m4*cos(t1)*cos(t2 ...
     % + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3) + ...
     % l3*m4*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3) - l3*m5*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*l3) + l3*m5*sin(t1)*cos(t2 + t3)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3) - lc3*m3*cos(t1)...
     % *cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3) + ...
     % lc3*m3*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3) + m4*cos(t1)*sin(t2 + t3)*l3*sin(t1)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)) - m4*sin(t1)*sin(t2 + t3)*l3...
     % *cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos(t1)*sin(t2 + t3)...
     % *l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) - m5*sin(t1)*sin(t2 + ...
     % t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*sin(...
     % (t2) + t3)*lc3*sin(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)) - m3*sin(t1)...
     % *sin(t2 + t3)*lc3*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2))) - ...
     % t1_d*t2_d*(Iyy2*cos(t2)*sin(t2) + Iyy2*sin(t2)*cos(t2) + Iyy3*cos(...
     % (t2) + t3)*sin(t2 + t3) + Iyy3*sin(t2 + t3)*cos(t2 + t3) + m4*sin...
     % (t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)) + m4*sin(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos...
     % (t2))*(sin(t2)*l2 + sin(t2 + t3)*l3) + m5*sin(t1)...
     % *sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + ...
     % t3) + l2*sin(t2)) + m5*sin(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(...
     % (t2))*l2 + sin(t2 + t3)*l3) + m3*sin(t1)*sin(t1)*(cos...
     % (t2)*l2 + cos(t2 + t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin...
     % (t2)) + m3*sin(t1)*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*...
     % (l2) + sin(t2 + t3)*lc3) + m4*cos(t1)*cos(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + ...
     % m4*cos(t1)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin...
     % (t2 + t3)*l3) + m5*cos(t1)*cos(t1)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos(t1)...
     % *cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + ...
     % (t3))*l3) + m3*cos(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*cos(t1)*...
     % (lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)...
     % *lc3) + lc2*m2*cos(t1)*cos(t2)*lc2*cos(t1)*sin(t2) + ...
     % lc2*m2*cos(t1)*sin(t2)*lc2*cos(t1)*cos(t2) + lc2*m2*cos(t2)...
     % *sin(t1)*lc2*sin(t1)*sin(t2) + lc2*m2*sin(t1)*sin(t2)*...
     % (lc2)*cos(t2)*sin(t1)) - t1_d*t3_d*(Iyy3*cos(t2 + t3)*sin(t2 + t3) + ...
     % Iyy3*sin(t2 + t3)*cos(t2 + t3) + l3*m4*cos(t1)*sin(t2 + t3)*cos(t1)...
     % *(cos(t2)*l2 + cos(t2 + t3)*l3) + l3*m5*cos(t1)...
     % *sin(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3) + ...
     % lc3*m3*cos(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3) + l3*m4*sin(t1)*sin(t2 + t3)*sin(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*l3) + l3*m5*sin(t1)*sin(t2 + t3)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3) + lc3*m3*sin(t1)...
     % *sin(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3) + ...
     % m4*cos(t1)*sin(t2 + t3)*l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos...
     % (t2)) + m5*cos(t1)*sin(t2 + t3)*l3*cos(t1)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)) + m3*cos(t1)*sin(t2 + t3)*lc3*cos(t1)*(lc3*cos(t2 ...
     % + t3) + l2*cos(t2)) + m4*sin(t1)*sin(t2 + t3)*l3*sin(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2)) + m5*sin(t1)*sin(t2 + t3)*l3...
     % *sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m3*sin(t1)*sin(t2 + t3)...
     % *lc3*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))) + t2_d*t3_d*(Iyy3*cos(t1)...
     % *sin(t2 + t3)*sin(t2 + t3)*sin(t1) - Iyy3*sin(t1)*sin(t2 + ...
     % t3)*sin(t2 + t3)*cos(t1) - Iyy3*cos(t1)*cos(t2 + t3)*cos(t2 + ...
     % t3)*sin(t1) + Iyy3*sin(t1)*cos(t2 + t3)*cos(t2 + t3)*cos(t1) - ...
     % l3*m4*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3) + l3*m4*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*l3) - l3*m5*cos(t1)*cos(t2 + t3)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3) + l3*m5*sin(t1)...
     % *cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3) - ...
     % lc3*m3*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3) + lc3*m3*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*lc3) + l3*m4*cos(t1)*sin(t2 + t3)*sin(t1)...
     % *(sin(t2)*l2 + sin(t2 + t3)*l3) - l3*m4*sin(t1)...
     % *sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3) + ...
     % l3*m5*cos(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3) - l3*m5*sin(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*...
     % (l2) + sin(t2 + t3)*l3) + lc3*m3*cos(t1)*sin(t2 + t3)*sin(t1)...
     % *(sin(t2)*l2 + sin(t2 + t3)*lc3) - lc3*m3*sin(t1)...
     % *sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3))

     % V2 = t3_d^2*((cos(t1)*(Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + ...
     % t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*sin(t1)*cos(t2 + ...
     % t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))...
     % /2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + ...
     % t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*cos(t1)*cos(t2 + ...
     % t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))...
     % /2 - l3*m4*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)*l3) ...
     % - l3*m5*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)*l3) - ...
     % lc3*m3*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)*lc3) + ...
     % (l3*m4*cos(t2 + t3)*sin(t2 + t3)*l3)/2 - (l3*m4*sin(t2 + ...
     % (t3))*cos(t2 + t3)*l3)/2 + (l3*m5*cos(t2 + t3)*sin(t2 + t3)*...
     % (l3))/2 - (l3*m5*sin(t2 + t3)*cos(t2 + t3)*l3)/2 + (lc3*m3*cos(...
     % (t2) + t3)*sin(t2 + t3)*lc3)/2 - (lc3*m3*sin(t2 + t3)*cos(t2 ...
     % + t3)*lc3)/2 + l3*m4*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 ...
     % + sin(t2 + t3)*l3) + l3*m5*cos(t1)*cos(t2 + t3)*cos(t1)*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3) + lc3*m3*cos(t1)*cos...
     % (t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3) + ...
     % l3*m4*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3) + l3*m5*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*...
     % (l2) + sin(t2 + t3)*l3) + lc3*m3*sin(t1)*cos(t2 + t3)*sin(t1)...
     % *(sin(t2)*l2 + sin(t2 + t3)*lc3) + (l3*m4*cos(t1)...
     % *cos(t2 + t3)*sin(t2 + t3)*l3*cos(t1))/2 - (l3*m4*cos(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*l3*cos(t1))/2 + (l3*m5*cos(t1)*cos...
     % (t2 + t3)*sin(t2 + t3)*l3*cos(t1))/2 - (l3*m5*cos(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*l3*cos(t1))/2 + (lc3*m3*cos(t1)*cos...
     % (t2 + t3)*sin(t2 + t3)*lc3*cos(t1))/2 - (lc3*m3*cos(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*lc3*cos(t1))/2 + (l3*m4*sin(t1)*cos...
     % (t2 + t3)*sin(t2 + t3)*l3*sin(t1))/2 - (l3*m4*sin(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*l3*sin(t1))/2 + (l3*m5*sin(t1)*cos...
     % (t2 + t3)*sin(t2 + t3)*l3*sin(t1))/2 - (l3*m5*sin(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*l3*sin(t1))/2 + (lc3*m3*sin(t1)*cos...
     % (t2 + t3)*sin(t2 + t3)*lc3*sin(t1))/2 - (lc3*m3*sin(t1)*sin...
     % (t2 + t3)*cos(t2 + t3)*lc3*sin(t1))/2) + t1_d^2*((Iyy2*cos(...
     % (t2))*sin(t2))/2 + (Iyy2*sin(t2)*cos(t2))/2 + (Iyy3*cos(t2 + t3)...
     % *sin(t2 + t3))/2 + (Iyy3*sin(t2 + t3)*cos(t2 + t3))/2 + (m4*sin(t1)...
     % *sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + ...
     % t3) + l2*sin(t2)))/2 + (m4*sin(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3))/2 + (m5*sin(t1)*sin...
     % (t1)*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m5*sin(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(...
     % (t2))*l2 + sin(t2 + t3)*l3))/2 + (m3*sin(t1)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*lc3)*(lc3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m3*sin(t1)*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))*(sin(...
     % (t2))*l2 + sin(t2 + t3)*lc3))/2 + (m4*cos(t1)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m4*cos(t1)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(...
     % (t2))*l2 + sin(t2 + t3)*l3))/2 + (m5*cos(t1)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m5*cos(t1)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(...
     % (t2))*l2 + sin(t2 + t3)*l3))/2 + (m3*cos(t1)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*lc3)*(lc3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m3*cos(t1)*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))*(sin(...
     % (t2))*l2 + sin(t2 + t3)*lc3))/2 + (lc2*m2*cos(t1)*cos...
     % (t2)*lc2*cos(t1)*sin(t2))/2 + (lc2*m2*cos(t1)*sin(t2)*...
     % (lc2)*cos(t1)*cos(t2))/2 + (lc2*m2*cos(t2)*sin(t1)*lc2*sin(t1)*sin...
     % (t2))/2 + (lc2*m2*sin(t1)*sin(t2)*lc2*cos(t2)*sin(t1))/2) + t2_d^2*...
     % ((cos(t1)*(Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + t3)...
     % *sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*sin(t1)*cos(t2 + ...
     % t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))...
     % /2 - (sin(t1)*(Iyy2*cos(t1)*sin(t2)*(cos(t1)*cos(t2)*sin(t1) - sin...
     % (t1)*cos(t1)*cos(t2)) + Iyy2*cos(t1)*cos(t2)*(cos(t1)*sin(t1)...
     % *sin(t2) - sin(t1)*cos(t1)*sin(t2))))/2 + (cos(t1)*(Iyy2*sin(t1)*sin(...
     % (t2))*(cos(t1)*cos(t2)*sin(t1) - sin(t1)*cos(t1)*cos(t2)) + Iyy2*cos(...
     % (t2))*sin(t1)*(cos(t1)*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2))))...
     % /2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + ...
     % t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*cos(t1)*cos(t2 + ...
     % t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))...
     % /2 - (m4*(cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*sin(t2 + ...
     % t3) + l2*sin(t2)))/2 - (m4*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + ...
     % sin(t2 + t3)*l3))/2 - (m5*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 - (m5*(l3*cos(t2 + t3) + l2*cos...
     % (t2))*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 - (m3*(cos(...
     % (t2))*l2 + cos(t2 + t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)))...
     % /2 - (m3*(lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3))/2 + (m4*sin(t1)*sin(t1)*(cos(t2)*l2 + cos...
     % (t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m4*sin(t1)...
     % *sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + ...
     % (t3))*l3))/2 + (m5*sin(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 ...
     % + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m5*sin(t1)*sin(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)...
     % *l3))/2 + (m3*sin(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*sin(t1)*sin(t1)*...
     % (lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)...
     % *lc3))/2 - (lc2*m2*cos(t2)*lc2*sin(t2))/2 - (lc2*m2*sin(t2)...
     % *lc2*cos(t2))/2 + (m4*cos(t1)*cos(t1)*(cos(t2)*l2 + cos(...
     % (t2) + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m4*cos(t1)*cos...
     % (t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + ...
     % (t3))*l3))/2 + (m5*cos(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 ...
     % + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m5*cos(t1)*cos(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)...
     % *l3))/2 + (m3*cos(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*cos(t1)*cos(t1)*...
     % (lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*l2 + sin(t2 + t3)...
     % *lc3))/2 + (lc2*m2*cos(t1)*cos(t2)*lc2*cos(t1)*sin(t2))/2 + ...
     % (lc2*m2*cos(t1)*sin(t2)*lc2*cos(t1)*cos(t2))/2 + (lc2*m2*cos(...
     % (t2))*sin(t1)*lc2*sin(t1)*sin(t2))/2 + (lc2*m2*sin(t1)*sin(...
     % (t2))*lc2*cos(t2)*sin(t1))/2) - t1_d*t2_d*((Iyy3*sin(t2 + t3)*(cos...
     % (t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1)))/2 + (Iyy2*sin...
     % (t2)*(cos(t1)*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2)))/2 - ...
     % (Iyy3*cos(t2 + t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)...
     % *cos(t2 + t3)*cos(t1)))/2 - (Iyy2*cos(t2)*(cos(t1)*cos(t2)*sin(t1) - sin...
     % (t1)*cos(t1)*cos(t2)))/2 + (m4*cos(t1)*sin(t1)*(sin(t2)*l2 + ...
     % sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 - (m4*sin(...
     % (t1))*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3)*(l3*sin(t2 ...
     % + t3) + l2*sin(t2)))/2 + (m5*cos(t1)*sin(t1)*(sin(t2)*l2 + sin(...
     % (t2) + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 - (m5*sin(t1)*cos...
     % (t1)*(sin(t2)*l2 + sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m3*cos(t1)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 - (m3*sin(t1)*cos(t1)*...
     % (sin(t2)*l2 + sin(t2 + t3)*lc3)*(lc3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 - (m4*cos(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m4*sin(t1)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 - (m5*cos(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m5*sin(t1)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 - (m3*cos(t1)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + (m3*sin(t1)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*lc3)*(lc3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 - (lc2*m2*cos(t1)*cos(t2)*lc2*cos(t2)*sin(t1))/2 + ...
     % (lc2*m2*cos(t2)*sin(t1)*lc2*cos(t1)*cos(t2))/2 + (lc2*m2*cos(...
     % (t1))*sin(t2)*lc2*sin(t1)*sin(t2))/2 - (lc2*m2*sin(t1)*sin(...
     % (t2))*lc2*cos(t1)*sin(t2))/2) - t1_d*t3_d*((Iyy3*sin(t2 + t3)*(cos...
     % (t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1)))/2 - (Iyy3*cos...
     % (t2 + t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + ...
     % t3)*cos(t1)))/2 + l3*m4*cos(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + ...
     % sin(t2 + t3)*l3) - l3*m4*sin(t1)*sin(t2 + t3)*cos(t1)*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3) + l3*m5*cos(t1)*sin(t2 ...
     % + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3) - ...
     % l3*m5*sin(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3) + lc3*m3*cos(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*...
     % (l2) + sin(t2 + t3)*lc3) - lc3*m3*sin(t1)*sin(t2 + t3)*cos...
     % (t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3) - (m4*cos(...
     % (t1))*cos(t2 + t3)*l3*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + ...
     % (m4*sin(t1)*cos(t2 + t3)*l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos...
     % (t2)))/2 - (m5*cos(t1)*cos(t2 + t3)*l3*sin(t1)*(l3*cos(t2 + ...
     % t3) + l2*cos(t2)))/2 + (m5*sin(t1)*cos(t2 + t3)*l3*cos(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m3*cos(t1)*cos(t2 + t3)*...
     % (lc3)*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + (m3*sin(t1)*cos(t2 + ...
     % t3)*lc3*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 - (m4*cos(t1)...
     % *sin(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + ...
     % (m4*sin(t1)*sin(t2 + t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin...
     % (t2)))/2 - (m5*cos(t1)*sin(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + ...
     % t3) + l2*sin(t2)))/2 + (m5*sin(t1)*sin(t2 + t3)*l3*cos(t1)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)))/2 - (m3*cos(t1)*sin(t2 + t3)*...
     % (lc3)*sin(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*sin(t1)*sin(t2 + ...
     % t3)*lc3*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2) + t2_d*t3_d*((cos(t1)...
     % *(Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - ...
     % sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*sin(t1)*cos(t2 + t3)*...
     % (cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))/2 - (sin...
     % (t1)*(Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + t3)*sin(t1) ...
     % - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*cos(t1)*cos(t2 + t3)*...
     % (cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))/2 - ...
     % (l3*m4*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)*l3))/2 - ...
     % (l3*m5*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)*l3))/2 - ...
     % (lc3*m3*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)*lc3))/2 ...
     % - (l3*m4*cos(t2 + t3)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 ...
     % - (l3*m5*cos(t2 + t3)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 ...
     % - (lc3*m3*cos(t2 + t3)*(sin(t2)*l2 + sin(t2 + t3)*lc3))...
     % /2 + (l3*m4*cos(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 ...
     % + t3)*l3))/2 + (l3*m5*cos(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3))/2 + (lc3*m3*cos(t1)*sin(t2 + ...
     % t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3))/2 + ...
     % (l3*m4*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3))/2 + (l3*m5*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)...
     % *l2 + sin(t2 + t3)*l3))/2 + (lc3*m3*cos(t1)*cos(t2 + ...
     % t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3))/2 + ...
     % (l3*m4*sin(t1)*sin(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3))/2 + (l3*m5*sin(t1)*sin(t2 + t3)*sin(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3))/2 + (lc3*m3*sin(t1)*sin(t2 + ...
     % t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3))/2 + ...
     % (l3*m4*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3))/2 + (l3*m5*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)...
     % *l2 + sin(t2 + t3)*l3))/2 + (lc3*m3*sin(t1)*cos(t2 + ...
     % t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3))/2) - ...
     % t1_d*t2_d*((Iyy3*cos(t1)*sin(t2 + t3)*sin(t2 + t3)*sin(t1))/2 - ...
     % (Iyy3*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*cos(t1))/2 + (m4*cos(...
     % (t1))*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3)*(l3*sin(t2 ...
     % + t3) + l2*sin(t2)))/2 - (m4*sin(t1)*cos(t1)*(sin(t2)*l2 + sin(...
     % (t2) + t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m5*cos(t1)*sin...
     % (t1)*(sin(t2)*l2 + sin(t2 + t3)*l3)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 - (m5*sin(t1)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*cos(t1)*sin(t1)*...
     % (sin(t2)*l2 + sin(t2 + t3)*lc3)*(lc3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 - (m3*sin(t1)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 - (m4*cos(t1)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 + (m4*sin(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m5*cos(t1)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 + (m5*sin(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m3*cos(t1)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*lc3)*(lc3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 + (m3*sin(t1)*cos(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 - (Iyy2*cos(t1)*cos...
     % (t2)*cos(t2)*sin(t1))/2 + (Iyy2*cos(t2)*sin(t1)*cos(t1)*cos(t2))/2 ...
     % - (Iyy3*cos(t1)*cos(t2 + t3)*cos(t2 + t3)*sin(t1))/2 + (Iyy3*sin...
     % (t1)*cos(t2 + t3)*cos(t2 + t3)*cos(t1))/2 + (Iyy2*cos(t1)*sin...
     % (t2)*sin(t1)*sin(t2))/2 - (Iyy2*sin(t1)*sin(t2)*cos(t1)*sin(t2))/2 ...
     % - (lc2*m2*cos(t1)*cos(t2)*lc2*cos(t2)*sin(t1))/2 + (lc2*m2*cos(...
     % (t2))*sin(t1)*lc2*cos(t1)*cos(t2))/2 + (lc2*m2*cos(t1)*sin(...
     % (t2))*lc2*sin(t1)*sin(t2))/2 - (lc2*m2*sin(t1)*sin(t2)*lc2...
     % *cos(t1)*sin(t2))/2) + t2_d*t3_d*((cos(t1)*(Iyy3*sin(t1)*sin(t2 + ...
     % (t3))*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + ...
     % Iyy3*sin(t1)*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin...
     % (t1)*sin(t2 + t3)*cos(t1))))/2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + ...
     % t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + ...
     % Iyy3*cos(t1)*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin...
     % (t1)*sin(t2 + t3)*cos(t1))))/2 - l3*m4*sin(t2 + t3)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*l3) - l3*m5*sin(t2 + t3)*(cos(t2)*l2 + cos...
     % (t2 + t3)*l3) - lc3*m3*sin(t2 + t3)*(cos(t2)*l2 + cos...
     % (t2 + t3)*lc3) - (m4*sin(t2 + t3)*l3*(l3*cos(t2 + ...
     % t3) + l2*cos(t2)))/2 - (m5*sin(t2 + t3)*l3*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 - (m3*sin(t2 + t3)*lc3*(lc3*cos(t2 + t3) + l2*cos...
     % (t2)))/2 + (m4*cos(t2 + t3)*l3*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + ...
     % (m5*cos(t2 + t3)*l3*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*cos...
     % (t2 + t3)*lc3*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 + l3*m4*cos(...
     % (t1))*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*...
     % (l3)) + l3*m5*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(...
     % (t2) + t3)*l3) + lc3*m3*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)...
     % *l2 + sin(t2 + t3)*lc3) + l3*m4*sin(t1)*cos(t2 + t3)...
     % *sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3) + l3*m5*sin...
     % (t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)...
     % *l3) + lc3*m3*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin...
     % (t2 + t3)*lc3) - (m4*cos(t1)*sin(t2 + t3)*...
     % (l3)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m5*cos(t1)*sin(t2 + ...
     % t3)*l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m3*cos(t1)*sin...
     % (t2 + t3)*lc3*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + (m4*cos...
     % (t1)*cos(t2 + t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))...
     % /2 + (m5*cos(t1)*cos(t2 + t3)*l3*cos(t1)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m3*cos(t1)*cos(t2 + t3)*lc3*cos(t1)*...
     % (lc3*sin(t2 + t3) + l2*sin(t2)))/2 - (m4*sin(t1)*sin(t2 + t3)*...
     % (l3)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m5*sin(t1)*sin(t2 + ...
     % t3)*l3*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m3*sin(t1)*sin...
     % (t2 + t3)*lc3*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + (m4*sin...
     % (t1)*cos(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))...
     % /2 + (m5*sin(t1)*cos(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + (m3*sin(t1)*cos(t2 + t3)*lc3*sin(t1)*...
     % (lc3*sin(t2 + t3) + l2*sin(t2)))/2) - t1_d*t3_d*((Iyy3*cos(t1)*sin(t2 + ...
     % t3)*sin(t2 + t3)*sin(t1))/2 - (Iyy3*sin(t1)*sin(t2 + t3)*sin...
     % (t2 + t3)*cos(t1))/2 - (Iyy3*cos(t1)*cos(t2 + t3)*cos(t2 + t3)*sin...
     % (t1))/2 + (Iyy3*sin(t1)*cos(t2 + t3)*cos(t2 + t3)*cos(t1))/2 - ...
     % (l3*m4*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3))/2 + (l3*m4*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)...
     % *l2 + cos(t2 + t3)*l3))/2 - (l3*m5*cos(t1)*cos(t2 + t3)...
     % *sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*l3))/2 + (l3*m5*sin...
     % (t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)...
     % *l3))/2 - (lc3*m3*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*lc3))/2 + (lc3*m3*sin(t1)*cos(t2 + t3)*cos(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*lc3))/2 + (l3*m4*cos(...
     % (t1))*sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*...
     % (l3)))/2 - (l3*m4*sin(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin...
     % (t2 + t3)*l3))/2 + (l3*m5*cos(t1)*sin(t2 + t3)*sin(t1)*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3))/2 - (l3*m5*sin(t1)...
     % *sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 ...
     % + (lc3*m3*cos(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3))/2 - (lc3*m3*sin(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)...
     % *l2 + sin(t2 + t3)*lc3))/2)

     % V3 = t1_d^2*((Iyy3*cos(t2 + t3)*sin(t2 + t3))/2 + (Iyy3*sin(t2 + ...
     % (t3))*cos(t2 + t3))/2 + (l3*m4*cos(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)*...
     % (l2) + cos(t2 + t3)*l3))/2 + (l3*m5*cos(t1)*sin(t2 + t3)*cos...
     % (t1)*(cos(t2)*l2 + cos(t2 + t3)*l3))/2 + (lc3*m3*cos...
     % (t1)*sin(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)...
     % *lc3))/2 + (l3*m4*sin(t1)*sin(t2 + t3)*sin(t1)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*l3))/2 + (l3*m5*sin(t1)*sin(t2 + t3)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3))/2 + (lc3*m3*sin(...
     % (t1))*sin(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (lc3)))/2 + (m4*cos(t1)*sin(t2 + t3)*l3*cos(t1)*(l3*cos(t2 + ...
     % t3) + l2*cos(t2)))/2 + (m5*cos(t1)*sin(t2 + t3)*l3*cos(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m3*cos(t1)*sin(t2 + t3)*...
     % (lc3)*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + (m4*sin(t1)*sin(t2 + ...
     % t3)*l3*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m5*sin(t1)*sin...
     % (t2 + t3)*l3*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m3*sin...
     % (t1)*sin(t2 + t3)*lc3*sin(t1)*(lc3*cos(t2 + t3) + l2*cos...
     % (t2)))/2) + t2_d^2*((cos(t1)*(Iyy3*sin(t1)*sin(t2 + t3)*(cos(...
     % (t1))*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*sin(t1)...
     % *cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 ...
     % + t3)*cos(t1))))/2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + t3)*(cos(...
     % (t1))*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*cos(t1)...
     % *cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 ...
     % + t3)*cos(t1))))/2 + (l3*m4*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3))/2 + (l3*m5*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*l3))/2 + (lc3*m3*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 ...
     % + t3)*lc3))/2 - (m4*sin(t2 + t3)*l3*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 - (m5*sin(t2 + t3)*l3*(l3*cos(t2 + t3) + l2*cos...
     % (t2)))/2 - (m3*sin(t2 + t3)*lc3*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 ...
     % - m4*cos(t2 + t3)*l3*(l3*sin(t2 + t3) + l2*sin(t2)) - m5*cos(...
     % (t2) + t3)*l3*(l3*sin(t2 + t3) + l2*sin(t2)) - m3*cos(t2 + ...
     % (t3))*lc3*(lc3*sin(t2 + t3) + l2*sin(t2)) - (l3*m4*cos(t1)*cos(t2 + t3)...
     % *cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 - (l3*m5*cos...
     % (t1)*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)...
     % *l3))/2 - (lc3*m3*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + ...
     % sin(t2 + t3)*lc3))/2 - (l3*m4*sin(t1)*cos(t2 + t3)*sin(t1)*...
     % (sin(t2)*l2 + sin(t2 + t3)*l3))/2 - (l3*m5*sin(...
     % (t1))*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*...
     % (l3)))/2 - (lc3*m3*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin...
     % (t2 + t3)*lc3))/2 + m4*cos(t1)*sin(t2 + t3)*...
     % (l3)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t1)*sin(t2 + ...
     % (t3))*l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos(t1)*sin(t2 ...
     % + t3)*lc3*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)) + (m4*cos(t1)*cos...
     % (t2 + t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m5*cos...
     % (t1)*cos(t2 + t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))...
     % /2 + (m3*cos(t1)*cos(t2 + t3)*lc3*cos(t1)*(lc3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 + m4*sin(t1)*sin(t2 + t3)*l3*sin(t1)*(l3*cos...
     % (t2 + t3) + l2*cos(t2)) + m5*sin(t1)*sin(t2 + t3)*l3*sin(t1)*...
     % (l3*cos(t2 + t3) + l2*cos(t2)) + m3*sin(t1)*sin(t2 + t3)*lc3...
     % *sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)) + (m4*sin(t1)*cos(t2 + t3)...
     % *l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m5*sin(t1)*cos(t2 ...
     % + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*sin(t1)...
     % *cos(t2 + t3)*lc3*sin(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2) + ...
     % t3_d^2*((cos(t1)*(Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + ...
     % t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*sin(t1)*cos(t2 + ...
     % t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))...
     % /2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)*cos(t2 + ...
     % t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*cos(t1)*cos(t2 + ...
     % t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))))...
     % /2 - (l3*m4*cos(t2 + t3)*sin(t2 + t3)*l3)/2 - (l3*m4*sin(t2 + ...
     % t3)*cos(t2 + t3)*l3)/2 - (l3*m5*cos(t2 + t3)*sin(t2 + t3)...
     % *l3)/2 - (l3*m5*sin(t2 + t3)*cos(t2 + t3)*l3)/2 - (lc3*m3*cos...
     % (t2 + t3)*sin(t2 + t3)*lc3)/2 - (lc3*m3*sin(t2 + t3)...
     % *cos(t2 + t3)*lc3)/2 + (l3*m4*cos(t1)*cos(t2 + t3)*sin(t2 + ...
     % t3)*l3*cos(t1))/2 + (l3*m4*cos(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*cos(t1))/2 + (l3*m5*cos(t1)*cos(t2 + t3)*sin(t2 + t3)...
     % *l3*cos(t1))/2 + (l3*m5*cos(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*cos(t1))/2 + (lc3*m3*cos(t1)*cos(t2 + t3)*sin(t2 + t3)...
     % *lc3*cos(t1))/2 + (lc3*m3*cos(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *lc3*cos(t1))/2 + (l3*m4*sin(t1)*cos(t2 + t3)*sin(t2 + t3)...
     % *l3*sin(t1))/2 + (l3*m4*sin(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*sin(t1))/2 + (l3*m5*sin(t1)*cos(t2 + t3)*sin(t2 + t3)...
     % *l3*sin(t1))/2 + (l3*m5*sin(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*sin(t1))/2 + (lc3*m3*sin(t1)*cos(t2 + t3)*sin(t2 + t3)...
     % *lc3*sin(t1))/2 + (lc3*m3*sin(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *lc3*sin(t1))/2) - t1_d*t2_d*((Iyy3*cos(t1)*sin(t2 + t3)*sin...
     % (t2 + t3)*sin(t1))/2 - (Iyy3*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*cos...
     % (t1))/2 - (Iyy3*cos(t1)*cos(t2 + t3)*cos(t2 + t3)*sin(t1))/2 + ...
     % (Iyy3*sin(t1)*cos(t2 + t3)*cos(t2 + t3)*cos(t1))/2 - (l3*m4*cos...
     % (t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)...
     % *l3))/2 + (l3*m4*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + ...
     % cos(t2 + t3)*l3))/2 - (l3*m5*cos(t1)*cos(t2 + t3)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3))/2 + (l3*m5*sin(...
     % (t1))*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (l3)))/2 - (lc3*m3*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos...
     % (t2 + t3)*lc3))/2 + (lc3*m3*sin(t1)*cos(t2 + t3)*cos(t1)*(cos...
     % (t2)*l2 + cos(t2 + t3)*lc3))/2 + (m4*cos(t1)*sin...
     % (t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 - (m4*sin...
     % (t1)*sin(t2 + t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))...
     % /2 + (m5*cos(t1)*sin(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + ...
     % l2*sin(t2)))/2 - (m5*sin(t1)*sin(t2 + t3)*l3*cos(t1)*(l3*sin...
     % (t2 + t3) + l2*sin(t2)))/2 + (m3*cos(t1)*sin(t2 + t3)*lc3*sin...
     % (t1)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 - (m3*sin(t1)*sin(t2 + t3)...
     % *lc3*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2) - t1_d*t2_d*((Iyy3*sin(...
     % (t2) + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos...
     % (t1)))/2 - (Iyy3*cos(t2 + t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - sin...
     % (t1)*cos(t2 + t3)*cos(t1)))/2 - (l3*m4*cos(t1)*sin(t2 + t3)*sin(t1)*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3))/2 + (l3*m4*sin(t1)...
     % *sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 ...
     % - (l3*m5*cos(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*l3))/2 + (l3*m5*sin(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)...
     % *l2 + sin(t2 + t3)*l3))/2 - (lc3*m3*cos(t1)*sin(t2 + ...
     % t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*lc3))/2 + ...
     % (lc3*m3*sin(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3))/2 - (m4*cos(t1)*cos(t2 + t3)*l3*sin(t1)...
     % *(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m4*sin(t1)*cos(t2 + t3)*...
     % (l3)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m5*cos(t1)*cos(t2 + ...
     % t3)*l3*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m5*sin(t1)*cos...
     % (t2 + t3)*l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m3*cos...
     % (t1)*cos(t2 + t3)*lc3*sin(t1)*(lc3*cos(t2 + t3) + l2*cos...
     % (t2)))/2 + (m3*sin(t1)*cos(t2 + t3)*lc3*cos(t1)*(lc3*cos(t2 + ...
     % t3) + l2*cos(t2)))/2 + m4*cos(t1)*sin(t2 + t3)*l3*sin(t1)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)) - m4*sin(t1)*sin(t2 + t3)*l3...
     % *cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos(t1)*sin(t2 + t3)...
     % *l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) - m5*sin(t1)*sin(t2 + ...
     % t3)*l3*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*sin(...
     % (t2) + t3)*lc3*sin(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)) - m3*sin(t1)...
     % *sin(t2 + t3)*lc3*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2))) + ...
     % t2_d*t3_d*((cos(t1)*(Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*cos...
     % (t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*sin(t1)*cos(...
     % (t2) + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos...
     % (t1))))/2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)*cos...
     % (t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + Iyy3*cos(t1)*cos(...
     % (t2) + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos...
     % (t1))))/2 + (l3*m4*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + t3)...
     % *l3))/2 + (l3*m5*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + ...
     % (t3))*l3))/2 + (lc3*m3*sin(t2 + t3)*(cos(t2)*l2 + cos(t2 + ...
     % t3)*lc3))/2 - l3*m4*cos(t2 + t3)*sin(t2 + t3)*l3 - ...
     % (l3*m4*sin(t2 + t3)*cos(t2 + t3)*l3)/2 - l3*m5*cos(t2 + ...
     % (t3))*sin(t2 + t3)*l3 - (l3*m5*sin(t2 + t3)*cos(t2 + t3)*l3)...
     % /2 - lc3*m3*cos(t2 + t3)*sin(t2 + t3)*lc3 - (lc3*m3*sin(t2 + ...
     % t3)*cos(t2 + t3)*lc3)/2 - (l3*m4*cos(t1)*cos(t2 + t3)*cos(t1)*(sin...
     % (t2)*l2 + sin(t2 + t3)*l3))/2 - (l3*m5*cos(t1)...
     % *cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 ...
     % - (lc3*m3*cos(t1)*cos(t2 + t3)*cos(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3))/2 - (l3*m4*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)...
     % *l2 + sin(t2 + t3)*l3))/2 - (l3*m5*sin(t1)*cos(t2 + t3)...
     % *sin(t1)*(sin(t2)*l2 + sin(t2 + t3)*l3))/2 - ...
     % (lc3*m3*sin(t1)*cos(t2 + t3)*sin(t1)*(sin(t2)*l2 + sin(t2 + ...
     % t3)*lc3))/2 + (l3*m4*cos(t1)*cos(t2 + t3)*sin(t2 + t3)...
     % *l3*cos(t1))/2 + l3*m4*cos(t1)*sin(t2 + t3)*cos(t2 + t3)*...
     % (l3)*cos(t1) + (l3*m5*cos(t1)*cos(t2 + t3)*sin(t2 + t3)*l3...
     % *cos(t1))/2 + l3*m5*cos(t1)*sin(t2 + t3)*cos(t2 + t3)*l3*cos...
     % (t1) + (lc3*m3*cos(t1)*cos(t2 + t3)*sin(t2 + t3)*lc3*cos(t1))...
     % /2 + lc3*m3*cos(t1)*sin(t2 + t3)*cos(t2 + t3)*lc3*cos(t1) + ...
     % (l3*m4*sin(t1)*cos(t2 + t3)*sin(t2 + t3)*l3*sin(t1))/2 + ...
     % l3*m4*sin(t1)*sin(t2 + t3)*cos(t2 + t3)*l3*sin(t1) + ...
     % (l3*m5*sin(t1)*cos(t2 + t3)*sin(t2 + t3)*l3*sin(t1))/2 + ...
     % l3*m5*sin(t1)*sin(t2 + t3)*cos(t2 + t3)*l3*sin(t1) + ...
     % (lc3*m3*sin(t1)*cos(t2 + t3)*sin(t2 + t3)*lc3*sin(t1))/2 + ...
     % lc3*m3*sin(t1)*sin(t2 + t3)*cos(t2 + t3)*lc3*sin(t1)) - ...
     % t1_d*t3_d*((Iyy3*cos(t1)*sin(t2 + t3)*sin(t2 + t3)*sin(t1))/2 - ...
     % (Iyy3*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*cos(t1))/2 - (Iyy3*cos(...
     % (t1))*cos(t2 + t3)*cos(t2 + t3)*sin(t1))/2 + (Iyy3*sin(t1)*cos(...
     % (t2) + t3)*cos(t2 + t3)*cos(t1))/2 - (l3*m4*cos(t1)*cos(t2 + t3)*sin(t1)*...
     % (cos(t2)*l2 + cos(t2 + t3)*l3))/2 + (l3*m4*sin(...
     % (t1))*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(t2 + t3)*...
     % (l3)))/2 - (l3*m5*cos(t1)*cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos...
     % (t2 + t3)*l3))/2 + (l3*m5*sin(t1)*cos(t2 + t3)*cos(t1)*(cos...
     % (t2)*l2 + cos(t2 + t3)*l3))/2 - (lc3*m3*cos(t1)...
     % *cos(t2 + t3)*sin(t1)*(cos(t2)*l2 + cos(t2 + t3)*lc3))...
     % /2 + (lc3*m3*sin(t1)*cos(t2 + t3)*cos(t1)*(cos(t2)*l2 + cos(...
     % (t2) + t3)*lc3))/2 + (l3*m4*cos(t1)*sin(t2 + t3)*sin(t2 ...
     % + t3)*l3*sin(t1))/2 - (l3*m4*sin(t1)*sin(t2 + t3)*sin(t2 + ...
     % t3)*l3*cos(t1))/2 + (l3*m5*cos(t1)*sin(t2 + t3)*sin(t2 + t3)...
     % *l3*sin(t1))/2 - (l3*m5*sin(t1)*sin(t2 + t3)*sin(t2 + t3)...
     % *l3*cos(t1))/2 + (lc3*m3*cos(t1)*sin(t2 + t3)*sin(t2 + t3)...
     % *lc3*sin(t1))/2 - (lc3*m3*sin(t1)*sin(t2 + t3)*sin(t2 + t3)...
     % *lc3*cos(t1))/2) + t2_d*t3_d*((cos(t1)*(Iyy3*sin(t1)*sin(t2 + ...
     % (t3))*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + ...
     % Iyy3*sin(t1)*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin...
     % (t1)*sin(t2 + t3)*cos(t1))))/2 - (sin(t1)*(Iyy3*cos(t1)*sin(t2 + ...
     % t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)) + ...
     % Iyy3*cos(t1)*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin...
     % (t1)*sin(t2 + t3)*cos(t1))))/2 - (m4*sin(t2 + t3)*l3*(l3*cos...
     % (t2 + t3) + l2*cos(t2)))/2 - (m5*sin(t2 + t3)*l3*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 - (m3*sin(t2 + t3)*lc3*(lc3*cos(t2 + t3) + l2*cos...
     % (t2)))/2 - (l3*m4*cos(t2 + t3)*sin(t2 + t3)*l3)/2 - (l3*m5*cos(...
     % (t2) + t3)*sin(t2 + t3)*l3)/2 - (lc3*m3*cos(t2 + t3)*sin(t2 + ...
     % t3)*lc3)/2 + (m4*cos(t1)*cos(t2 + t3)*l3*cos(t1)*...
     % (l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m5*cos(t1)*cos(t2 + t3)*...
     % (l3)*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + (m3*cos(t1)*cos(t2 + ...
     % t3)*lc3*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)))/2 + (m4*sin(t1)...
     % *cos(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)))/2 + ...
     % (m5*sin(t1)*cos(t2 + t3)*l3*sin(t1)*(l3*sin(t2 + t3) + l2*sin...
     % (t2)))/2 + (m3*sin(t1)*cos(t2 + t3)*lc3*sin(t1)*(lc3*sin(t2 + ...
     % t3) + l2*sin(t2)))/2 + (l3*m4*cos(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*cos(t1))/2 + (l3*m5*cos(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*cos(t1))/2 + (lc3*m3*cos(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *lc3*cos(t1))/2 + (l3*m4*sin(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*sin(t1))/2 + (l3*m5*sin(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *l3*sin(t1))/2 + (lc3*m3*sin(t1)*sin(t2 + t3)*cos(t2 + t3)...
     % *lc3*sin(t1))/2) - t1_d*t3_d*((Iyy3*sin(t2 + t3)*(cos(t1)*sin...
     % (t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1)))/2 - (Iyy3*cos(t2 + ...
     % t3)*(cos(t1)*cos(t2 + t3)*sin(t1) - sin(t1)*cos(t2 + t3)*cos(t1)))...
     % /2 - (m4*cos(t1)*cos(t2 + t3)*l3*sin(t1)*(l3*cos(t2 + t3) + ...
     % l2*cos(t2)))/2 + (m4*sin(t1)*cos(t2 + t3)*l3*cos(t1)*(l3*cos...
     % (t2 + t3) + l2*cos(t2)))/2 - (m5*cos(t1)*cos(t2 + t3)*l3*sin...
     % (t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 + (m5*sin(t1)*cos(t2 + t3)...
     % *l3*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)))/2 - (m3*cos(t1)*cos(t2 ...
     % + t3)*lc3*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + (m3*sin(t1)...
     % *cos(t2 + t3)*lc3*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)))/2 + ...
     % (l3*m4*cos(t1)*sin(t2 + t3)*sin(t2 + t3)*l3*sin(t1))/2 - ...
     % (l3*m4*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*l3*cos(t1))/2 + ...
     % (l3*m5*cos(t1)*sin(t2 + t3)*sin(t2 + t3)*l3*sin(t1))/2 - ...
     % (l3*m5*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*l3*cos(t1))/2 + ...
     % (lc3*m3*cos(t1)*sin(t2 + t3)*sin(t2 + t3)*lc3*sin(t1))/2 - ...
     % (lc3*m3*sin(t1)*sin(t2 + t3)*sin(t2 + t3)*lc3*cos(t1))/2)

     % V4 = 0;
     % V5 = 0;

     % % TINH D
     % D = [D11 D12 D13 D14 D15;...
     %      D21 D22 D23 D24 D25;...
     %      D31 D32 D33 D34 D35;...
     %      D41 D42 D43 D44 D45;...
     %      D51 D52 D53 D54 D55;];

     % % TINH V
     % V = [V1; V2; V3; V4; V5;]

     % % TINH tau
     % %tau = D*q_dd + V + G
     % tau = D*q_dd + V + G

     px=cosd(t1)*(l3*cosd(t2+t3)+l2*cosd(t2)+l5*cosd(-90));
     py=sind(t1)*(l3*cosd(t2+t3)+l2*cosd(t2)+l5*cosd(-90));
     pz=l1+l3*sind(t2+t3)+l2*sind(t2)+l5*sind(-90);

     plot(px,pz,'.r'); xlabel('x'); ylabel('z'); title('Graph of Oxz')
     hold on
     grid on

     % MOMENT PLOT
     % plot(time(i),tau(1),'.r'); xlabel('Time (s)'); ylabel('Tau1 (Nm)');
     % plot(time(i),tau(2),'.g'); xlabel('Time (s)'); ylabel('Tau2 (Nm)');
     % plot(time(i),tau(3),'.b'); xlabel('Time (s)'); ylabel('Tau3 (Nm)');
     % plot(time(i),tau(4),'.k'); xlabel('Time (s)'); ylabel('Tau4 (Nm)');
     % plot(time(i),tau(5),'.y'); xlabel('Time (s)'); ylabel('Tau5 (Nm)');
     hold on
     grid on
end

for i = 0:0.001:1
 x = 500 - 500 * i;
 z = 900 - 300 * i;
 plot(x,z,'.b');
 hold on
 grid on
end
