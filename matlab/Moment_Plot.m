%% TAO TAP HOP CAC DIEM QUY DAO MO PHONG
% syms l1 l2 l3 l4 l5 lc1 lc2 lc3 lc4 lc5
% syms t1 t2 t3 t4 t5
% syms Ixx1 Iyy1 Iyy2 Iyy3 Iyy4 Iyy5 Izz5
% syms m1 m2 m3 m4 m5

Ixx1 = 461147
Iyy1 = 299920
Iyy2 = 803322
Iyy3 = 1604504
Iyy4 = 6328
Iyy5 = 24861 
Izz5 = 14388 

m1 = 27.5 %kg
m2 = 24.0
m3 = 25.0
m4 = 3.0
m5 = 2.0

t1 = 0 %rad
t2 = 0
t3 = 0
t4 = - pi / 2
t5 = 0

l1 = 0.690 %m
l2 = 0.440
l3 = 0.500
l4 = 0.0
l5 = 0.230

lc1 = 0.660 %m
lc2 = 0.255
lc3 = 0.143
lc4 = 0.6
lc5 = 0.143

%% RUT GON KET QUA BIEU THUC G
G1 = 0
G2 = (49*m4*(l3*cos(t2 + t3) + l2*cos(t2)))/5 + (49*m5*(l3*cos(t2 + t3) + l2*cos(t2)))/5 + (49*m3*(lc3*cos(t2 + t3) + l2*cos(t2)))/5 + (49*lc2*m2*cos(t2))/5
G3 = (49*l3*m4*cos(t2 + t3))/5 + (49*l3*m5*cos(t2 + t3))/5 + (49*lc3*m3*cos(t2 + t3))/5
G4 = 0
G5 = 0

%% RUT GON KET QUA BIEU THUC D
D11 = Iyy1 + Izz5 + Iyy2*cos(t2)*cos(t2) + Iyy3*cos(t2 + t3)*cos(t2 + t3) ...
+ m4*cos(t1)*cos(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj...
(l3))*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t1)*cos(t1)*(cos(t2)*conj...
(l2) + cos(t2 + t3)*conj(l3))*(l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos...
(t1)*cos(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj(lc3))*...
(lc3*cos(t2 + t3) + l2*cos(t2)) + m4*sin(t1)*sin(t1)*(cos(t2)*conj(l2) + ...
cos(t2 + t3)*conj(l3))*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*sin(t1)...
*sin(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj(l3))*(l3*cos(t2 + ...
t3) + l2*cos(t2)) + m3*sin(t1)*sin(t1)*(cos(t2)*conj(l2) + cos(t2 + ...
t3)*conj(lc3))*(lc3*cos(t2 + t3) + l2*cos(t2)) + lc2*m2*cos(t1)*cos(conj...
(t2))*conj(lc2)*cos(t1)*cos(t2) + lc2*m2*cos(t2)*sin(t1)*conj(lc2)*cos...
(t2)*sin(t1)

D12 = Iyy2*sin(t1)*sin(t2)*cos(t1)*cos(t2) - Iyy2*cos(t1)*sin(t2)...
*cos(t2)*sin(t1) - m4*cos(t1)*sin(t1)*(cos(t2)*conj(l2) + cos(t2 + ...
t3)*conj(l3))*(l3*sin(t2 + t3) + l2*sin(t2)) + m4*sin(t1)*cos(t1)*(cos...
(t2)*conj(l2) + cos(t2 + t3)*conj(l3))*(l3*sin(t2 + t3) + l2*sin...
(t2)) - m5*cos(t1)*sin(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)...
*conj(l3))*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*sin(t1)*cos(t1)*(cos(t2)...
*conj(l2) + cos(t2 + t3)*conj(l3))*(l3*sin(t2 + t3) + l2*sin(t2)) - ...
m3*cos(t1)*sin(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj...
(lc3))*(lc3*sin(t2 + t3) + l2*sin(t2)) + m3*sin(t1)*cos(t1)*(cos(t2)*conj...
(l2) + cos(t2 + t3)*conj(lc3))*(lc3*sin(t2 + t3) + l2*sin(t2)) - Iyy3*cos...
(t1)*sin(t2 + t3)*cos(t2 + t3)*sin(t1) + Iyy3*sin(t1)*sin...
(t2 + t3)*cos(t2 + t3)*cos(t1) - lc2*m2*cos(t1)*cos(t2)*conj...
(lc2)*sin(t1)*sin(t2) + lc2*m2*cos(t2)*sin(t1)*conj(lc2)*cos(t1)*sin(t2)

D13 = Iyy3*sin(t1)*sin(t2 + t3)*cos(t2 + t3)*cos(t1) - Iyy3*cos(t1)...
*sin(t2 + t3)*cos(t2 + t3)*sin(t1) - l3*m4*cos(t1)*sin(t2 + t3)*sin...
(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj(l3)) + l3*m4*sin(conj...
(t1))*sin(t2 + t3)*cos(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj...
(l3)) - l3*m5*cos(t1)*sin(t2 + t3)*sin(t1)*(cos(t2)*conj(l2) + cos(conj...
(t2) + t3)*conj(l3)) + l3*m5*sin(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)...
*conj(l2) + cos(t2 + t3)*conj(l3)) - lc3*m3*cos(t1)*sin(t2 + t3)...
*sin(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)*conj(lc3)) + lc3*m3*sin...
(t1)*sin(t2 + t3)*cos(t1)*(cos(t2)*conj(l2) + cos(t2 + t3)...
*conj(lc3))

D14 = 0

D15 = -Izz5

D21 = Iyy2*cos(t2)*(cos(t1)*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2)) + ...
Iyy3*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin...
(t2 + t3)*cos(t1)) + m4*cos(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin...
(t2)*conj(l2) + sin(t2 + t3)*conj(l3)) - m4*sin(t1)*cos(t1)*...
(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*conj(l2) + sin(t2 + t3)...
*conj(l3)) + m5*cos(t1)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)...
*conj(l2) + sin(t2 + t3)*conj(l3)) - m5*sin(t1)*cos(t1)*(l3*cos(t2 ...
+ t3) + l2*cos(t2))*(sin(t2)*conj(l2) + sin(t2 + t3)*conj(l3)) + ...
m3*cos(t1)*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))*(sin(t2)*conj(l2) + ...
sin(t2 + t3)*conj(lc3)) - m3*sin(t1)*cos(t1)*(lc3*cos(t2 + t3) + ...
l2*cos(t2))*(sin(t2)*conj(l2) + sin(t2 + t3)*conj(lc3)) + ...
lc2*m2*cos(t1)*sin(t2)*conj(lc2)*cos(t2)*sin(t1) - lc2*m2*sin(t1)...
*sin(t2)*conj(lc2)*cos(t1)*cos(t2)

D22 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
(t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
(t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(conj...
(t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(conj...
(t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy2*cos(t1)*(cos(t1)...
*cos(t1) + sin(t1)*sin(t1)) + Iyy2*sin(t1)*sin(t2)*(cos(t1)...
*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2))) + sin(t1)*(Iyy2*sin(t1)*(cos...
(t1)*cos(t1) + sin(t1)*sin(t1)) - Iyy2*cos(t1)*sin(t2)*(cos...
(t1)*sin(t1)*sin(t2) - sin(t1)*cos(t1)*sin(t2))) + cos(t1)*(Iyy5*(cos...
(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos...
(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*...
(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)...
*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + ...
m4*(cos(t2)*conj(l2) + cos(t2 + t3)*conj(l3))*(l3*cos(t2 + t3) + ...
l2*cos(t2)) + m5*(cos(t2)*conj(l2) + cos(t2 + t3)*conj(l3))*(l3*cos...
(t2 + t3) + l2*cos(t2)) + m3*(cos(t2)*conj(l2) + cos(t2 + t3)*conj...
(lc3))*(lc3*cos(t2 + t3) + l2*cos(t2)) + m4*cos(t1)*cos(t1)*(sin(t2)*conj...
(l2) + sin(t2 + t3)*conj(l3))*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos...
(t1)*cos(t1)*(sin(t2)*conj(l2) + sin(t2 + t3)*conj(l3))*...
(l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*cos(t1)*(sin(t2)*conj(l2) + ...
sin(t2 + t3)*conj(lc3))*(lc3*sin(t2 + t3) + l2*sin(t2)) + lc2*m2*cos(conj...
(t2))*conj(lc2)*cos(t2) + m4*sin(t1)*sin(t1)*(sin(t2)*conj(l2) + sin(conj...
(t2) + t3)*conj(l3))*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*sin(t1)*sin(t1)*...
(sin(t2)*conj(l2) + sin(t2 + t3)*conj(l3))*(l3*sin(t2 + t3) + ...
l2*sin(t2)) + m3*sin(t1)*sin(t1)*(sin(t2)*conj(l2) + sin(t2 + conj...
(t3))*conj(lc3))*(lc3*sin(t2 + t3) + l2*sin(t2)) + lc2*m2*cos(t1)*sin(t2)...
*conj(lc2)*cos(t1)*sin(t2) + lc2*m2*sin(t1)*sin(t2)*conj(lc2)*sin(t1)*sin...
(t2)

D23 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
(t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
(t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(conj...
(t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(conj...
(t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(t1)*cos(t5) ...
+ sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - ...
sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos(t1)*sin(conj...
(t5)) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin(t5) - cos(t5)*sin...
(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + l3*m4*cos(t2 + t3)*(cos...
(t2)*conj(l2) + cos(t2 + t3)*conj(l3)) + l3*m5*cos(t2 + t3)*(cos...
(t2)*conj(l2) + cos(t2 + t3)*conj(l3)) + lc3*m3*cos(t2 + t3)*(cos...
(t2)*conj(l2) + cos(t2 + t3)*conj(lc3)) + l3*m4*cos(t1)*sin...
(t2 + t3)*cos(t1)*(sin(t2)*conj(l2) + sin(t2 + t3)*conj(l3)) + ...
l3*m5*cos(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*conj(l2) + sin(t2 + ...
t3)*conj(l3)) + lc3*m3*cos(t1)*sin(t2 + t3)*cos(t1)*(sin(t2)*conj...
(l2) + sin(t2 + t3)*conj(lc3)) + l3*m4*sin(t1)*sin(t2 + t3)*sin(t1)...
*(sin(t2)*conj(l2) + sin(t2 + t3)*conj(l3)) + l3*m5*sin(t1)...
*sin(t2 + t3)*sin(t1)*(sin(t2)*conj(l2) + sin(t2 + t3)*conj(l3)) + ...
lc3*m3*sin(t1)*sin(t2 + t3)*sin(t1)*(sin(t2)*conj(l2) + sin(t2 + ...
t3)*conj(lc3))

D24 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
(t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
(t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(conj...
(t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

D25 = 0

D31 = Iyy3*cos(t2 + t3)*(cos(t1)*sin(t2 + t3)*sin(t1) - sin(t1)*sin...
(t2 + t3)*cos(t1)) + m4*cos(t1)*sin(t2 + t3)*conj(l3)*sin(t1)*...
(l3*cos(t2 + t3) + l2*cos(t2)) - m4*sin(t1)*sin(t2 + t3)*conj(l3)...
*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t1)*sin(t2 + t3)...
*conj(l3)*sin(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) - m5*sin(t1)*sin(t2 + ...
t3)*conj(l3)*cos(t1)*(l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos(t1)*sin(conj...
(t2) + t3)*conj(lc3)*sin(t1)*(lc3*cos(t2 + t3) + l2*cos(t2)) - m3*sin(t1)...
*sin(t2 + t3)*conj(lc3)*cos(t1)*(lc3*cos(t2 + t3) + l2*cos(t2))

D32 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
(t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
(t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(conj...
(t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(conj...
(t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(t1)*cos(t5) ...
+ sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - ...
sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos(t1)*sin(conj...
(t5)) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin(t5) - cos(t5)*sin...
(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + m4*cos(t2 + conj...
(t3))*conj(l3)*(l3*cos(t2 + t3) + l2*cos(t2)) + m5*cos(t2 + t3)*conj(l3)*...
(l3*cos(t2 + t3) + l2*cos(t2)) + m3*cos(t2 + t3)*conj(lc3)*(lc3*cos(t2 + ...
t3) + l2*cos(t2)) + m4*cos(t1)*sin(t2 + t3)*conj(l3)*cos(t1)*...
(l3*sin(t2 + t3) + l2*sin(t2)) + m5*cos(t1)*sin(t2 + t3)*conj(l3)...
*cos(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*cos(t1)*sin(t2 + t3)...
*conj(lc3)*cos(t1)*(lc3*sin(t2 + t3) + l2*sin(t2)) + m4*sin(t1)*sin(t2 + ...
t3)*conj(l3)*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m5*sin(t1)*sin(conj...
(t2) + t3)*conj(l3)*sin(t1)*(l3*sin(t2 + t3) + l2*sin(t2)) + m3*sin(t1)...
*sin(t2 + t3)*conj(lc3)*sin(t1)*(lc3*sin(t2 + t3) + l2*sin(t2))

D33 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy3*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy3*sin(t1)*sin(t2 + t3)*(cos(t1)*sin(t2 + t3)...
*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) + cos(t1)*(Iyy4*cos(t1)*(cos...
(t1)*cos(t1) + sin(t1)*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin...
(t1) - sin(t1)*cos(t1))) + sin(t1)*(Iyy3*sin(t1)*(cos(t1)*cos(t1) + ...
sin(t1)*sin(t1)) - Iyy3*cos(t1)*sin(t2 + t3)*(cos(t1)...
*sin(t2 + t3)*sin(t1) - sin(t1)*sin(t2 + t3)*cos(t1))) - sin(t1)*(Iyy4*cos(conj...
(t1))*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin(t1)*(cos(conj...
(t1))*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(t1)*cos(t5) ...
+ sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - ...
sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos(t1)*sin(conj...
(t5)) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin(t5) - cos(t5)*sin...
(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)))) + l3*m4*cos(t2 + ...
t3)*cos(t2 + t3)*conj(l3) + l3*m5*cos(t2 + t3)*cos(t2 + t3)*conj...
(l3) + lc3*m3*cos(t2 + t3)*cos(t2 + t3)*conj(lc3) + l3*m4*cos(t1)...
*sin(t2 + t3)*sin(t2 + t3)*conj(l3)*cos(t1) + l3*m5*cos(t1)*sin...
(t2 + t3)*sin(t2 + t3)*conj(l3)*cos(t1) + lc3*m3*cos(t1)*sin(conj...
(t2) + t3)*sin(t2 + t3)*conj(lc3)*cos(t1) + l3*m4*sin(t1)*sin(t2 + ...
t3)*sin(t2 + t3)*conj(l3)*sin(t1) + l3*m5*sin(t1)*sin(t2 + conj...
(t3))*sin(t2 + t3)*conj(l3)*sin(t1) + lc3*m3*sin(t1)*sin(t2 + t3)...
*sin(t2 + t3)*conj(lc3)*sin(t1)

D34 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
(t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
(t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(conj...
(t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

D35 = 0

D41 = 0

D42 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
(t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
(t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(conj...
(t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

D43 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
(t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
(t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(conj...
(t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

D44 = sin(t1)*(Iyy5*(cos(t1)*cos(t5) + sin(t1)*sin(t5))*(cos(conj...
(t1))*(cos(t1)*sin(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)...
*sin(t5))) - Iyy5*(cos(t1)*sin(t5) - cos(t5)*sin(t1))*(cos...
(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos...
(t5)*sin(t1)))) + cos(t1)*(Iyy4*cos(t1)*(cos(t1)*cos(t1) + sin(t1)...
*sin(t1)) + Iyy4*sin(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1))) - sin...
(t1)*(Iyy4*cos(t1)*(cos(t1)*sin(t1) - sin(t1)*cos(t1)) - Iyy4*sin...
(t1)*(cos(t1)*cos(t1) + sin(t1)*sin(t1))) + cos(t1)*(Iyy5*(cos(conj...
(t1))*cos(t5) + sin(t1)*sin(t5))*(cos(t1)*(cos(t1)*cos(t5) + ...
sin(t1)*sin(t5)) - sin(t1)*(cos(t1)*sin(t5) - cos(t5)*sin(t1))) + Iyy5*(cos...
(t1)*sin(t5) - cos(t5)*sin(t1))*(cos(t1)*(cos(t1)*sin...
(t5) - cos(t5)*sin(t1)) + sin(t1)*(cos(t1)*cos(t5) + sin(t1)*sin(t5))))

D45 = 0

D51 = -Izz5

D52 = 0

D53 = 0

D54 = 0

D55 = Izz5

%% RUT GON KET QUA BIEU THUC V
% V1 = 0
% V2 = 0
% V3 = 0
% V4 = 0
% V5 = 0

%% TAO MA TRAN GIA TOC
t1_dd = 1;
t2_dd = 1;
t3_dd = 1;
t4_dd = 1;
t5_dd = 1;

q_dd = [t1_dd ; t2_dd ; t3_dd ; t4_dd ; t5_dd];

D = [D11 D12 D13 D14 D15;...
     D21 D22 D23 D24 D25;...
     D31 D32 D33 D34 D35;...
     D41 D42 D43 D44 D45;...
     D51 D52 D53 D54 D55;];

tau = D*q_dd

